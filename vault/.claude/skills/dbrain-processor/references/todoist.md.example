# Todoist Integration

## Available MCP Tools

### Reading Tasks
- `get-overview` — all projects with hierarchy
- `find-tasks` — search by text, project, section
- `find-tasks-by-date` — tasks by date range

### Writing Tasks
- `add-tasks` — create new tasks
- `complete-tasks` — mark as done
- `update-tasks` — modify existing

---

## Pre-Creation Checklist

### 1. Check Workload (REQUIRED)

```
find-tasks-by-date:
  startDate: "today"
  daysCount: 7
  limit: 50
```

Build workload map:
```
Mon: 2 tasks
Tue: 4 tasks  ← overloaded
Wed: 1 task
Thu: 3 tasks  ← at limit
Fri: 2 tasks
Sat: 0 tasks
Sun: 0 tasks
```

### 2. Check Duplicates (REQUIRED)

```
find-tasks:
  searchText: "key words from new task"
```

If similar exists → mark as duplicate, don't create.

---

## Priority by Domain

Based on user's work context (see [ABOUT.md](ABOUT.md)):

| Domain | Default Priority | Override |
|--------|-----------------|----------|
| SaaS-продукты | p1-p2 | — |
| Консалтинг (клиент) | p1-p2 | — |
| Закупки | p2-p3 | — |
| GodKod Ops (urgent) | p2 | — |
| GodKod Ops (regular) | p3 | — |
| Контент (с дедлайном) | p2-p3 | — |
| Контент (идеи) | p4 | — |
| Личное | p4 | — |

### Priority Keywords

| Keywords in text | Priority |
|-----------------|----------|
| срочно, критично, партнёр ждёт, клиент | p1 |
| важно, приоритет, до конца недели | p2 |
| нужно, надо, не забыть | p3 |
| (стратегия, R&D, когда-нибудь) | p4 |

### Apply Decision Filters for Priority Boost

If entry matches 2+ filters → boost priority by 1 level:
- Это приближает к пассивному доходу?
- Это можно автоматизировать?
- Это усиливает экспертизу/медийку?
- Не требует раздувания команды?

---

## Date Mapping

| Context | dueString |
|---------|-----------|
| **Партнёр ждёт / клиент** | exact date или today |
| **Urgent ops** | today / tomorrow |
| **Эфир Нейроборщ** | monday 13:00 |
| **This week** | friday |
| **Next week** | next monday |
| **Strategic/R&D** | in 7 days |
| **Not specified** | in 3 days |

### Russian → dueString

| Russian | dueString |
|---------|-----------|
| сегодня | today |
| завтра | tomorrow |
| послезавтра | in 2 days |
| в понедельник | monday |
| в пятницу | friday |
| на этой неделе | friday |
| на следующей неделе | next monday |
| через неделю | in 7 days |
| 15 января | January 15 |

---

## Task Creation

```
add-tasks:
  tasks:
    - content: "Task title"
      dueString: "friday"  # MANDATORY
      priority: "p4"       # based on domain
      projectId: "..."     # if known
```

### Task Title Style

User prefers: прямота, ясность, конкретика

✅ Good:
- "Закрыть скоуп по голосовому боту"
- "Позвонить 5 бывшим клиентам — почему не купили пакет"
- "Найти 10 закупок на B2B Center"
- "Подготовить документы для заявки #1"
- "Эфир Нейроборщ — подготовить тему"

❌ Bad:
- "Подумать о боте"
- "Что-то с клиентами"
- "Разобраться с закупками"
- "Поработать над SaaS"

### Workload Balancing

If target day has 3+ tasks:
1. Find next day with < 3 tasks
2. Use that day instead
3. Mention in report: "сдвинуто на {day} (перегрузка)"

---

## Project Detection

| Keywords | Project |
|----------|---------|
| маркировка, ОРД, ERID, акты | SaaS — Маркировка |
| голосовой бот, ассистент, звонки | SaaS — Голосовой бот |
| транскрибация, бот | SaaS — Транскрибатор |
| консалтинг, клиент, консультация, кейс | Консалтинг |
| закупка, тендер, B2B Center, заявка | Закупки |
| Нейроборщ, эфир, пост, контент | Контент |
| GodKod, процесс, инфраструктура | GodKod Ops |
| семья, путешествие, бег, личное | Личное |

If unclear → use Inbox (no projectId).

---

## Recurring Tasks

| Task | Schedule |
|------|----------|
| Эфир Нейроборщ | every monday at 13:00 |
| Физ. активность | 3x per week |
| Чекап метрик SaaS | every friday |

---

## Anti-Patterns (НЕ СОЗДАВАТЬ)

Based on user preferences:

- ❌ "Подумать о..." → конкретизируй действие
- ❌ "Разобраться с..." → что именно сделать?
- ❌ Абстрактные задачи без Next Action
- ❌ Дубликаты существующих задач
- ❌ Задачи без дат
- ❌ Новые SaaS-идеи без валидации (у Виктора уже 20 не выстрелили)
- ❌ Задачи, требующие раздувания команды

---

## Error Handling

CRITICAL: Никогда не предлагай "добавить вручную".

If `add-tasks` fails:
1. Include EXACT error message in report
2. Continue with next entry
3. Don't mark as processed
4. User will see error and can debug

WRONG output:
  "Не удалось добавить (MCP недоступен). Добавь вручную: Task title"

CORRECT output:
  "Ошибка создания задачи: [exact error from MCP tool]"